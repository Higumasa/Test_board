<!--長谷川雅英--><html><head>   <meta charset="utf-8">   <title>KSBoard</title>   <link rel="stylesheet" href="style.css"></head><body><div id="page"><header><h1 class="pageTitle">KSBoard</h1></header><p><a href="post.php">ブログ記事の投稿はこちら</a></p><?phptry{  $dbh = new PDO('sqlite:blog.db','','');   //PDOクラスのオブジェクトの作成   $sth = $dbh->prepare("select * from posts order by id desc");   //prepareメソッドでSQL文の準備   $sth->execute();   //準備したSQL文の実行   while ($row = $sth->fetch()) {     //テーブルの内容を１行ずつ処理     $time = preg_split("/[\s.:-]+/",$row['date']);     if(!isset($row['date2'])){      $row['date2'] = $row['date'];     }     $time2 = preg_split("/[\s.:-]+/",$row['date2']);?>    <div id="contents">     <h3 class="title"><?php echo $row['title'] ?></h3>     <p>     <?php echo nl2br($row['contents']) ?><br>     <br>     (投稿日時:<?php echo $time[0]."/".$time[1]."/". $time[2]." ".$time[3]."  ".$time[4].":".$time[5] ?>)<br>     (最終投稿日時:<?php echo $time2[0]."/".$time2[1]."/". $time2[2]." ".$time2[3]."  ".$time2[4].":".$time2[5] ?>)     </p>      <form action="edit.php" method="post">        <p>        <input type="submit" value="編集" >        <input type="hidden" name="id" value="<?php echo $row['id'] ?>" >        <!-- <input type="hidden" name="date" value="<?php //echo $row['date'] ?>" > -->        </p>      </form>      <script>        //確認ダイアログの返り値によりフォーム送信        function submitChk(){          //確認ダイアログ表示          var flag = confirm ( "本当に削除しますか？\n\n削除したくない場合は[キャンセル]ボタンを押して下さい");          //send_flg が TRUEなら削除、FALSEなら削除しない          return flag;        }      </script>      <form action="delete.php" method="post" onsubmit="return submitChk()">      <p>      <input type="submit" value="削除">      パスワード:<input type="password" name="password" size="20">      <input type="hidden" name="id" value="<?php echo $row['id']?>">      </p>      </form>      <hr/>      <h3>コメント投稿</h3>        <form action="comment.php" method="post">        <p>          名前:<br><textarea name="name" rows="1" cols="30"></textarea><br>          コメント本文:<br><textarea name="contents" rows="2" cols="50"></textarea>          パスワード:<input type="password" name="commentpass" size="20">          <input type="hidden" name="pid" value="<?php echo $row['id'] ?>">          <input type="submit" value="投稿" />        </p>        </form>      </div>      <hr/>      <?php          $sth2 = $dbh->prepare("select * from comments order by id desc");          $sth2->execute();          while ($row2 = $sth2->fetch()) {            //テーブルの内容を１行ずつ処理            if($row['id'] == $row2['pid']){//postsのidと            $time2 = preg_split("/[\s.:-]+/",$row2['date']);      ?>      <div id="commentname">        投稿日時 (<?php echo $time[0]."/".$time[1]."/". $time[2]." ".$time[3]."  ".$time[4].":".$time[5] ?>)        [<?php echo $row2['name'] ?>さんのコメント]<br>      </div>      <div id="comments">        <?php echo $row2['contents'] ?><br>      </div>      <form action="delete.php" method="post" onsubmit="return submitChk()">        <p>          <input type="submit" value="削除">          パスワード:<input type="password" name="commentpass" size="20">          <input type="hidden" name="pid" value="<?php echo $row2['id']?>">        </p>      </form>      <hr/><?php      }    }  }} Catch (PDOException $e) {   print "エラー!: " . $e->getMessage() . "<br/>";   die();}?>  <p id="copyright"><small>Copyright&copy; 2017 @hasegawamasahide All Rights Reserved.</small></p>  </div></body></html>